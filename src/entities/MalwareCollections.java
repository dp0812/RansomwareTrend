package entities;

import java.util.ArrayList;
import java.util.Collections;

import fileReader.Logger;
import fileReader.ReadMalwareInfo;
import fileReader.WritableObject;

public class MalwareCollections {
    ReadMalwareInfo malwareDataset = new ReadMalwareInfo();
    ArrayList<Malware> malwareArrayList = new ArrayList<>();
    ArrayList<WritableObject> writableMalwareArrayList = new ArrayList<>();
    String inputFile;
    String outputFile;

    /**
     * @param dataFileName Name of the dataset. Default location is in datasets directory. 
     * @param writeFileName Name of the file to be written to. Default location is outputs directory. 
     */
    public final void setUpMalware(String dataFileName, String writeFileName){
        inputFile = dataFileName;
        outputFile = writeFileName; 
        malwareDataset.readCsvFile(dataFileName);
        malwareArrayList = malwareDataset.getMalwareArrayList();
        writableMalwareArrayList = malwareDataset.getWritableArrayList();
    }
    /**
     * Sort based on date, update both malwareArrayList and writable version of it.
     */
    public final void firstSeenSort(){
        Collections.sort(malwareArrayList);
        writableMalwareArrayList.clear();
        for (Malware m : malwareArrayList){
            WritableObject w = m;
            writableMalwareArrayList.add(w);
        }
    }

    public final void writeVisualizationData(){
        Logger.writeVisualizationData(writableMalwareArrayList, malwareDataset.getCategoryLine(),outputFile);
    }

    public ArrayList<Malware> getMalwareArrayList(){
        return this.malwareArrayList;
    }


}
